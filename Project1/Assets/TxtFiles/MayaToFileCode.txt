{
// construct the full path to a file
$filename = (`internalVar -userTmpDir` + "/../../../Desktop/HopeThisWorks.txt");

// open the file for writing
$file = `fopen $filename "w"`;

// get the connections and connected nodes, get selected object
string $selectedObjs[];
$selectedObjs = `ls -sl`;
string $node = $selectedObjs[0];

//Get all listConnections and add to array
$src_a = `listConnections -s true -d false -c true $node`;
$src_n = `listConnections -s true -d false $node`;

//prints the name of the node
fprint $file ($node+"\n");

//Go through all the connections on the node
for($i=0;$i<size($src_n);$i++) {
    //Need to get the second one of each due to staggered output values
    $j = $i*2;

    // query the node type of the connected node
    $type = `nodeType $src_n[$i]`;

    // see if it's a
    //   time to angular curve
    //   time to length curve  or a
    //   time to unitless curve
    if($type=="animCurveTA" ||
      $type=="animCurveTL" ||
      $type=="animCurveTU") 
        {
          //Name of the curve
          fprint $file ("\t"+$src_a[$j+1]+"\n");
          
          //How many keyframes are there?
          int $amountOfKeyframes = `keyframe -query -keyframeCount`;
          
          //Go through all keyframes
          for($q=0;$q<$amountOfKeyframes;$q++)
          {         
              //Gets the time of the keyframes in frames
              float $allKeyframeFrames[] = `keyframe -index $q -query $src_a[$j+1]`;
              
              //Goes through each keyframe time
              for($p=0;$p<size($allKeyframeFrames);$p++)
                {     
                  //prints the current keyframe to a file     
                  fprint $file ("\t\tKeyframe: " + $allKeyframeFrames[$p] + "\n");                  
                  
                  //Get all values at the keyframe
                  float $yeppers[] = `keyframe -t $allKeyframeFrames[$p] -q -eval $node`;
                  
                  //prints the value at the keyframe for the current curve
                  fprint $file ("\t\tValue: " + $yeppers[$i] + "\n\n"); 
                }
            }   
        }
    }

// close the file
fclose $file;
};